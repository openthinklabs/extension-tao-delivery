(function(){"use strict";var loaderScript=document.getElementById("amd-loader"),configUrl=loaderScript.getAttribute("data-config"),bundle=loaderScript.getAttribute("data-bundle"),loadController=function loadController(){var controllerOptions={},controllerPath=loaderScript.getAttribute("data-controller"),params=loaderScript.getAttribute("data-params");try{controllerOptions=JSON.parse(params)}catch(err){controllerOptions={}}window.require([controllerPath],function(controller){var startController=function startController(){window.started||(window.started=!0,controller.start(controllerOptions))};document.addEventListener("readystatechange",startController,!1),"complete"===document.readyState&&startController()})};window.require([configUrl],function(){window.loadBundles||(window.loaded={},window.loadBundles=function loadBundles(bundles){bundles=bundles||[],bundles=bundles.concat(window.bundles),bundles=bundles.filter(function(item,index){return item&&bundles.indexOf(item)===index&&!0!==window.loaded[item]}),require(bundles,function(){bundles.forEach(function(item){window.loaded[item]=!0}),loadController()})}),bundle||window.bundles&&window.bundles.length?window.loadBundles([bundle]):loadController()})})(),define("loader/bootstrap",function(){}),define("taoDelivery/controller/DeliveryServer/index",["jquery","lodash","i18n","module","core/router","ui/feedback","core/logger","layout/loading-bar","context","util/locale","url-polyfill"],function($,_,__,module,router,feedback,loggerFactory,loadingBar,context,locale){"use strict";const logger=loggerFactory("deliveryServer"),accessibilityLaunchKeyCodes=[13,32],displayPermanentMessage=(level,content)=>{level&&content&&feedback($(".permanent-feedback"))[level](content,{timeout:-1,popup:!1})},getLTIErrorParameters=()=>{const{searchParams}=new URL(window.location.href);return["lti_errormsg","lti_errorlog"].reduce((params,paramName)=>(searchParams.has(paramName)&&(params[paramName]=searchParams.get(paramName)),params),{})};return{start(parameters){let deliveryStarted=!1;const runDelivery=function runDelivery(url){"string"==typeof url&&0!==url.length&&(deliveryStarted=!0,loadingBar.start(),window.location.href=url)},supportRTL=function supportRTL(){$(".delivery-scope").attr({dir:locale.getLanguageDirection(context.locale)})},config=module.config();parameters&&parameters.messages&&parameters.messages.forEach(message=>{displayPermanentMessage(message.level,message.content)});const{lti_errormsg:ltiErrorMsg,lti_errorlog:ltiErrorLog}=getLTIErrorParameters();ltiErrorMsg&&displayPermanentMessage("error",ltiErrorMsg.length?ltiErrorMsg:__("An error occurred!"));;ltiErrorLog&&logger.error(ltiErrorLog);;const launchDelivery=function(e){const $elt=$(e.currentTarget);e.preventDefault(),e.stopPropagation(),deliveryStarted||$elt.hasClass("disabled")||runDelivery($elt.data().launch_url)};supportRTL(),$(".entry-point").on("click",launchDelivery),$(".entry-point").on("keyup",e=>{accessibilityLaunchKeyCodes.includes(e.which)&&launchDelivery(e)}),config&&Array.isArray(config.extraRoutes)&&config.extraRoutes.length&&router.dispatch(config.extraRoutes)}}}),define("taoDelivery/loader/deliveryServerIndex.bundle",function(){});
//# sourceMappingURL=deliveryServerIndex.min.js.map